---
title: LINUX SERVEUR
---

import SimpleAuth from '@site/src/components/SimpleAuth';

<SimpleAuth>

# üîß Guide Complet d'Administration Syst√®me

> **Auteur :** Gerardetienne  
> **Date de cr√©ation :** 2025-08-06  
> **Derni√®re mise √† jour :** 2025-08-06 08:12:34 UTC  
> **Version :** 5.0

---

## üìã Table des Mati√®res

1. [üåê Diagnostics R√©seau](#-diagnostics-r√©seau)
2. [üîë SSH et Authentification](#-ssh-et-authentification)
3. [üìä Surveillance Syst√®me](#-surveillance-syst√®me)
4. [üê≥ Docker Administration](#-docker-administration)
5. [üìù Gestion des Logs](#-gestion-des-logs)
6. [üéõÔ∏è Cron et T√¢ches Planifi√©es](#Ô∏è-cron-et-t√¢ches-planifi√©es)
7. [üêò WordPress et WP-CLI](#-wordpress-et-wp-cli)
8. [‚òÅÔ∏è AWS et Sauvegarde](#Ô∏è-aws-et-sauvegarde)
9. [üîê S√©curit√© et Permissions](#-s√©curit√©-et-permissions)
10. [üõ†Ô∏è Scripts Bash Avanc√©s](#Ô∏è-scripts-bash-avanc√©s)

---

## üåê Diagnostics R√©seau

### üîç R√©solution DNS
```bash
# R√©solution d'un nom de domaine
nslookup skiillz.com

# Obtenir l'IP publique du serveur
curl ifconfig.me
```

### üõ°Ô∏è Analyse de ports avec Nmap

> üìñ **Guide complet :** [Commandes Nmap](https://www.malekal.com/exemples-de-commandes-nmap/)

#### Installation
```bash
# Sur Debian/Ubuntu
sudo apt-get install nmap
```

#### Utilisation
```bash
# Scanner une machine distante
sudo nmap votre_domaine_ou_ip

# Scanner des ports sp√©cifiques
nmap -p 80,443 example.com
```

---

## üîë SSH et Authentification

### üö™ Connexion SSH avec cl√©

#### Avec fichier de cl√©
```bash
# Syntaxe g√©n√©rale
ssh -i "votre_cl√©_fichier" nom_user@adresse_ip

# Exemple concret
ssh -i "skiillz144007102021.pem" ubuntu@13.244.208.23
```

#### Sans cl√© (authentification par mot de passe)
```bash
ssh nom_user@adresse_ip
```

### üîß R√©solution des probl√®mes SSH

#### En cas de changement de cl√© d'h√¥te
```bash
ssh-keygen -R votre_adresse_ip
```

#### Correction des permissions de cl√© priv√©e

**Pour Linux :**
```bash
sudo chmod 400 skiillz_captown.pem
```

**Pour Windows :**
1. **Clic droit** sur le fichier `.pem`
2. **Propri√©t√©s** ‚Üí **S√©curit√©** ‚Üí **Avanc√©**
3. **D√©sactiver l'h√©ritage** ‚Üí **Convertir les autorisations h√©rit√©es**
4. **Supprimer** tous les utilisateurs sauf votre nom d'utilisateur
5. **Appliquer** les modifications

---

## üìä Surveillance Syst√®me

### üíæ Surveillance de l'espace disque
```bash
# Affichage g√©n√©ral de l'espace disque
sudo df -h /

# Affichage d√©taill√© avec type de syst√®me de fichiers
df -lh

# Affichage des p√©riph√©riques de stockage
lsblk
```

### üîç Analyse de la taille des fichiers et dossiers

> üìñ **Guide complet :** [V√©rifier l'espace disque sous Linux](https://waytolearnx.com/2019/05/10-commandes-pour-verifier-lespace-disque-sous-linux.html)

#### Top 10 des fichiers/dossiers les plus volumineux
```bash
# Dans le r√©pertoire courant
du -hsx * | sort -rh | head -10

# Recherche r√©cursive avec taille lisible
sudo du -ah --max-depth=1 / | sort -rh | head -n 10

# Taille d'un dossier sp√©cifique
du -sh 'nom_dossier'
```

### üß† Surveillance de la m√©moire RAM
```bash
# Affichage simple de la m√©moire
sudo free -h

# Affichage d√©taill√©
sudo free -m

# Pourcentage de RAM utilis√©e
free -m | awk 'NR==2{printf "%.2f%%\t\t", $3*100/$2 }'
```

### ‚ö° Surveillance CPU et performances
```bash
# Pourcentage d'utilisation CPU
top -bn1 | grep load | awk '{printf "%.2f%%\t\t\n", $(NF-2)}'

# Surveillance interactive
htop
```

### üë• Gestion des utilisateurs et groupes
```bash
# Ajouter un utilisateur √† un groupe
sudo usermod -aG www-data your_username

# Voir les groupes d'un utilisateur
groups ubuntu
```

---

## üê≥ Docker Administration

### üìã Gestion des conteneurs

#### Lister et inspecter
```bash
# Lister les conteneurs actifs
docker container list
docker container ps

# Voir les logs d'un conteneur
docker container logs id_de_container

# Logs en temps r√©el
docker container logs -f nom_container
```

#### Acc√®s aux conteneurs
```bash
# Entrer dans un conteneur
docker exec -it id_de_container /bin/bash

# Entrer avec un utilisateur sp√©cifique
docker exec -it -u www-data nom_container /bin/bash
```

#### Gestion des services
```bash
# D√©marrer les services (dans le dossier du projet)
docker-compose up

# Arr√™ter les services
docker-compose down

# D√©marrer un service sp√©cifique
docker-compose -f phpadmin.yml start
```

---

## üìù Gestion des Logs

### üîç Consultation des logs syst√®me

#### Logs Apache
```bash
# Logs d'erreur en temps r√©el
tail -f /var/log/apache2/error.log

# Recherche dans les logs d'erreur
grep "MaxRequestWorkers" /var/log/apache2/error.log
```

#### Logs WordPress
```bash
# Debug WordPress en temps r√©el
tail -f wp-content/debug.log

# Filtrer les erreurs
cat debug.log | grep error
```

#### Logs Cron
```bash
# Voir les t√¢ches cron ex√©cut√©es
grep CRON /var/log/syslog

# V√©rifier les processus cron
ps -aux | grep cron
```

### üßπ Nettoyage automatique des logs

> üìñ **Guide complet :** [Script de nettoyage des logs](https://fedingo.com/shell-script-to-clear-delete-log-files/)

#### Script de nettoyage
```bash name=delete-log.sh
#!/bin/sh

log_path="/var/log/apache"

# Supprimer les fichiers de plus de 30 jours
find $log_path* -mtime +30 -exec rm {} \;

echo 'Fichiers journaux de plus de 30 jours supprim√©s de $log_path'
```

#### Configuration et ex√©cution
```bash
# Rendre le script ex√©cutable
chmod +x /home/ubuntu/delete-log.sh

# Ajouter √† crontab pour ex√©cution quotidienne √† 10h
0 10 * * * /home/ubuntu/delete-log.sh >/dev/null 2>&1
```

---

## üéõÔ∏è Cron et T√¢ches Planifi√©es

> üìñ **Guides de r√©f√©rence :**
> - [Crontab Linux avec exemples](https://geekflare.com/fr/crontab-linux-with-real-time-examples-and-tools/)
> - [Automatiser les t√¢ches avec Cron](https://serverspace.io/support/help/automate-tasks-with-cron-ubuntu-20-04/)
> - [Planifier l'ex√©cution avec Cron](https://www.malekal.com/cron-planifier-execution-programme-script-linux/)

### ‚öôÔ∏è Gestion de Crontab
```bash
# √âditer les t√¢ches cron
crontab -e

# Lister les t√¢ches cron
crontab -l

# V√©rifier les processus cron
ps -aux | grep cron
```

### üìß Script d'alerte par email

#### Configuration pour surveillance RAM
```bash name=checkRam.sh
#!/bin/bash

# Script de surveillance RAM avec seuil √† 80%
ram_usage=$(free | awk '/Mem/ {printf("%.2f"), $3/$2 * 100}')

if (( $(echo "$ram_usage > 80.0" | bc -l) )); then
    # Envoyer alerte email
    swaks -t "admin@example.com" \
          -s smtp.gmail.com:587 -tls \
          -au "your_email@gmail.com" \
          -ap "your_app_password" \
          -f "your_email@gmail.com" \
          --h-Subject "Alert M√©moire serveur" \
          --body "Utilisation RAM: $ram_usage%"
    
    # Red√©marrer Apache si n√©cessaire
    sudo service apache2 restart
fi
```

---

## üêò WordPress et WP-CLI

> üìñ **Documentation officielle :** [WP-CLI Guide Kinsta](https://kinsta.com/fr/blog/wp-cli/)

### üì¶ Installation de WP-CLI
```bash
# T√©l√©charger WP-CLI
curl -O https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar

# V√©rifier l'installation
php wp-cli.phar --info

# Rendre ex√©cutable et d√©placer vers /usr/local/bin
chmod +x wp-cli.phar
sudo mv wp-cli.phar /usr/local/bin/wp

# V√©rifier la version
wp --version
```

### üîß Gestion des plugins

#### Lister et g√©rer
```bash
# Lister tous les plugins
wp plugin list --allow-root

# Activer un plugin
wp plugin activate wc-product-customer-list --allow-root

# Installer plusieurs plugins
wp plugin install advanced-custom-fields jetpack ninja-forms --activate

# Installer une version sp√©cifique
wp plugin update wc-product-customer-list --version=3.1.5 --allow-root
```

#### D√©sinstallation
```bash
# D√©sinstaller un plugin
wp plugin uninstall plugin_name

# D√©sactiver tous sauf certains
wp plugin uninstall --all --exclude=hello-dolly,jetpack
```

### üë• Gestion des utilisateurs

> üìñ **Documentation :** [WP-CLI User Commands](https://developer.wordpress.org/cli/commands/user/)

```bash
# Cr√©er un utilisateur administrateur
wp user create admindev dev_admin@example.com --role=administrator --allow-root

# Mettre √† jour un utilisateur
wp user update admindev --display_name="Admin Dev" --user_pass=newpassword

# Supprimer un utilisateur (r√©assigner le contenu)
wp user delete admindev --reassign=gerarddev

# Lister tous les utilisateurs
wp user list

# Lister seulement les IDs
wp user list --field=ID
```

### üóÑÔ∏è Gestion de la base de donn√©es

#### Import/Export
```bash
# Exporter la base de donn√©es
wp db export

# Importer une base de donn√©es
wp db import file.sql
```

#### Rechercher et remplacer

> üìñ **Guide :** [Search Replace WP-CLI](https://support.cloudways.com/en/articles/5126698-how-to-use-the-search-and-replace-function-of-wp-cli)

```bash
# Test de remplacement (dry-run)
wp search-replace "old-domain.com" "new-domain.com" --dry-run --allow-root

# Ex√©cution r√©elle
wp search-replace "speed.skiillz.com" "testpreprod.skiillz.com" --allow-root

# Requ√™tes SQL directes
wp db query "SELECT * FROM wp_users WHERE user_login = 'admin'"
```

---

## ‚òÅÔ∏è AWS et Sauvegarde

> üìñ **Guide officiel :** [AWS S3 CLI Backup](https://aws.amazon.com/fr/getting-started/hands-on/backup-to-s3-cli/)

### üõ†Ô∏è Installation AWS CLI
```bash
# Mise √† jour du syst√®me
sudo apt-get update

# Installation d'AWS CLI
sudo apt-get install awscli

# Alternative avec pip3
sudo apt-get install python3-pip
pip3 install awscli

# V√©rification
aws --version
```

### ‚öôÔ∏è Configuration AWS CLI
```bash
# Configuration interactive
aws configure
```

**Param√®tres requis :**
- **Access Key ID** : `[****************JNUS]`
- **Secret Access Key** : `[****************Dgdx]`
- **Default region** : `ap-southeast-1` (ou votre r√©gion)
- **Default output format** : `json`

### üìÅ Gestion des fichiers S3

#### Upload vers S3
```bash
# Cr√©er un bucket
aws s3 mb s3://my-backup-bucket

# Copier un fichier vers S3
aws s3 cp ./nom_file_√†_copier s3://your_bucket/nom_file_destination

# Exemple concret
aws s3 cp ./romuald-rousseaux.com-backup.wpress s3://romuald-backup/backup.wpress
```

#### Download depuis S3
```bash
# T√©l√©charger un fichier depuis S3
aws s3 cp s3://your_bucket/nom_file ./

# Exemple
aws s3 cp s3://www-skiillz-com/catalogue.zip ./
```

#### Suppression
```bash
# Supprimer un fichier S3
aws s3 rm s3://my-backup-bucket/my-file.bak
```

---

## üîê S√©curit√© et Permissions

### üìÇ Gestion des permissions

#### Permissions globales
```bash
# Permissions pour les dossiers (750)
sudo find /var/www/skiillz/ -type d -exec chmod 750 {} \;

# Permissions pour les fichiers (640)
sudo find /var/www/skiillz/ -type f -exec chmod 640 {} \;

# Permissions r√©cursives (attention !)
sudo chmod 777 -R /home/ubuntu/environment/WordPress/skiillz
```

#### Permissions utilisateur sp√©cifiques
```bash
# Ajouter droit lecture/√©criture pour le propri√©taire
chmod u+rw texte.txt

# Enlever droit d'√©criture pour groupe et autres
chmod go-w texte.txt

# Correction permissions avec red√©marrage Apache
chmod u+rw config.php
systemctl restart apache2
```

### üîÑ Changement d'utilisateur
```bash
# Basculer vers www-data
sudo -su www-data

# Pour Docker avec utilisateur sp√©cifique
docker exec -it -u www-data container_name /bin/bash
```

---

## üõ†Ô∏è Scripts Bash Avanc√©s

> üìñ **Initiation au scripting Bash :** [Guide NotaMax](https://notamax.be/bash-01-apprendre-a-scripter-sur-gnu-linux/)

### üìß Configuration Swaks pour emails

> üìñ **Tutorial vid√©o :** [Swaks Configuration](https://www.youtube.com/watch?v=zaOhO7Y2tIw)

#### Installation
```bash
sudo apt update
sudo apt -y install swaks
```

#### Utilisation basique
```bash
# Param√®tres Swaks
# -t      -> To (destinataire)
# -s      -> SMTP server
# -tls    -> Port 587 avec STARTTLS
# -au     -> Auth Username
# -ap     -> Auth Password
# -f      -> From (exp√©diteur)

swaks -t "admin@example.com" \
      -s smtp.gmail.com:587 -tls \
      -au "sender@gmail.com" \
      -ap "app_password" \
      -f "sender@gmail.com" \
      --h-Subject "Test Alert" \
      --body "Message de test"
```

#### Avec pi√®ce jointe
```bash
swaks -t "admin@example.com" \
      -s smtp.gmail.com:587 -tls \
      -au "sender@gmail.com" \
      -ap "app_password" \
      -f "sender@gmail.com" \
      --h-Subject "Rapport avec PJ" \
      --body "Voir pi√®ce jointe" \
      --attach '/home/ubuntu/report.txt'
```

### üîç Conditions et boucles Bash

> üìñ **Guide :** [Bash If-Else Statements](https://linuxize.com/post/bash-if-else-statement/)

#### Script de surveillance d'espace disque
```bash name=disk-alert.sh
#!/bin/bash

REALVALUE=$(df / | grep / | awk '{ print $5}' | sed 's/%//g')
THRESHOLD=80

if [ "$REALVALUE" -gt "$THRESHOLD" ]; then
    # Envoyer alerte par email
    swaks -t "admin@example.com" \
          -s smtp.gmail.com:587 -tls \
          -au "alert@example.com" \
          -ap "app_password" \
          -f "alert@example.com" \
          --h-Subject "ALERTE: Espace disque critique" \
          --body "Utilisation actuelle: $REALVALUE% (Seuil: $THRESHOLD%)"
    
    echo "Alerte envoy√©e - Utilisation disque: $REALVALUE%"
else
    echo "Utilisation disque normale: $REALVALUE%"
fi
```

#### Script de surveillance RAM avanc√©
```bash name=ram-monitor.sh
#!/bin/bash

# Variables de configuration
THRESHOLD=80
EMAIL_LIST="admin1@example.com admin2@example.com"

# R√©cup√©ration des m√©triques
RAM_USAGE=$(free -m | awk 'NR==2{printf "%.2f", $3*100/$2 }')
RAM_FREE=$(awk '/Mem:/ {print $4}' <(free -m))
RAM_USED=$(awk '/Mem:/ {print $3}' <(free -m))

# Test du seuil
if (( $(echo "$RAM_USAGE > $THRESHOLD" | bc -l) )); then
    # Construction du message
    MESSAGE="ALERTE MEMOIRE SERVEUR
    
Utilisation RAM: $RAM_USAGE%
M√©moire utilis√©e: ${RAM_USED}MB  
M√©moire libre: ${RAM_FREE}MB
Seuil d'alerte: $THRESHOLD%

Action recommand√©e: V√©rifier les processus en cours"

    # Envoi d'email √† multiple destinataires
    for EMAIL in $EMAIL_LIST; do
        swaks -t "$EMAIL" \
              -s smtp.gmail.com:587 -tls \
              -au "monitoring@example.com" \
              -ap "app_password" \
              -f "monitoring@example.com" \
              --h-Subject "üö® ALERTE RAM - Serveur $HOSTNAME" \
              --body "$MESSAGE"
    done
    
    # Red√©marrage Apache si n√©cessaire
    sudo service apache2 restart
    
    echo "$(date): Alerte RAM envoy√©e - Utilisation: $RAM_USAGE%"
else
    echo "$(date): RAM normale - Utilisation: $RAM_USAGE%"
fi
```

### üîß Gestion avanc√©e des scripts

#### Permissions d'ex√©cution
```bash
# Rendre un script ex√©cutable
chmod +x script_name

# Ou pour l'utilisateur uniquement
chmod u+x script_name
```

#### M√©thodes d'ex√©cution
```bash
# M√©thode 1: Ex√©cution directe
./script_name

# M√©thode 2: Via bash
bash script_name

# M√©thode 3: Via crontab (automatis√©)
# Dans crontab -e :
*/5 * * * * /path/to/script.sh >/dev/null 2>&1
```

---

## üîç Recherche et Filtrage Avanc√©s

### üîé Recherche avec Grep

#### Dans les fichiers
```bash
# Recherche r√©cursive simple
grep -r 'moodle/v1/cours' ./

# Recherche avanc√©e avec exclusions
grep -r --exclude-dir=node_modules --exclude-dir=.git --exclude-dir=dist "mot_√†_chercher" *

# Recherche avec num√©ros de ligne
grep -Hrn 'search term' path/to/files
```

#### Dans les logs
```bash
# Compter les occurrences d'une IP
grep "^154.126.16.65 " /var/log/apache2/access.log | wc -l

# Filtrer par type d'erreur
cat debug.log | grep error
```

### üìÅ Gestion avanc√©e des fichiers

#### Recherche par date
```bash
# Fichiers modifi√©s r√©cemment (2 derniers jours)
find /var/www/ -type f -mtime -2

# Supprimer les anciens logs
find /var/log/apache* -mtime +1 -exec rm {} \;
```

---

## üíæ Gestion de la M√©moire Virtuelle (Swap)

> üìñ **Guide complet :** [Ajouter du Swap sur Ubuntu](https://linuxize.com/post/how-to-add-swap-space-on-ubuntu-20-04/)

### üîß Cr√©ation d'un fichier Swap

#### √âtapes de configuration
```bash
# 1. Cr√©er un fichier de 6GB pour le swap
sudo fallocate -l 6G /swapfile

# 2. S√©curiser les permissions
sudo chmod 600 /swapfile

# 3. Configurer comme zone de swap
sudo mkswap /swapfile

# 4. Activer le swap
sudo swapon /swapfile

# 5. Rendre permanent
sudo nano /etc/fstab
# Ajouter: /swapfile swap swap defaults 0 0
```

#### V√©rification
```bash
# V√©rifier le swap actif
sudo swapon --show

# Voir l'usage m√©moire global
sudo free -h
```

---

## üõ°Ô∏è Maintenance et Surveillance

### üóÑÔ∏è Nettoyage de base de donn√©es MySQL

#### Purge des logs binaires
```bash
# Se connecter √† MySQL
sudo mysql

# Purger les logs de plus d'un jour
PURGE BINARY LOGS BEFORE DATE(NOW() - INTERVAL 1 DAY) + INTERVAL 0 SECOND;
```

### üìä Scripts de monitoring complets

#### Surveillance syst√®me globale
```bash name=system-monitor.sh
#!/bin/bash

# Configuration
LOG_FILE="/var/log/system-monitor.log"
ALERT_EMAIL="admin@example.com"

# Fonction de log
log_message() {
    echo "$(date '+%Y-%m-%d %H:%M:%S') - $1" >> $LOG_FILE
}

# V√©rification espace disque
DISK_USAGE=$(df / | grep / | awk '{ print $5}' | sed 's/%//g')
RAM_USAGE=$(free -m | awk 'NR==2{printf "%.0f", $3*100/$2 }')
CPU_LOAD=$(top -bn1 | grep "load average:" | awk '{printf "%.2f", $(NF-2)}')

# Rapport de status
REPORT="RAPPORT SYSTEME - $(date)

üíæ Espace disque: ${DISK_USAGE}%
üß† Utilisation RAM: ${RAM_USAGE}%  
‚ö° Charge CPU: ${CPU_LOAD}

Seuils d'alerte:
- Disque: 80%
- RAM: 80%
- CPU Load: 2.0"

# V√©rifications et alertes
ALERT_NEEDED=false

if [ "$DISK_USAGE" -gt 80 ]; then
    log_message "ALERTE: Espace disque critique - $DISK_USAGE%"
    ALERT_NEEDED=true
fi

if [ "$RAM_USAGE" -gt 80 ]; then
    log_message "ALERTE: M√©moire RAM critique - $RAM_USAGE%"
    ALERT_NEEDED=true
fi

# Envoyer rapport si alerte n√©cessaire
if [ "$ALERT_NEEDED" = true ]; then
    swaks -t "$ALERT_EMAIL" \
          -s smtp.gmail.com:587 -tls \
          -au "monitoring@example.com" \
          -ap "app_password" \
          -f "monitoring@example.com" \
          --h-Subject "üö® ALERTE SYSTEME - $HOSTNAME" \
          --body "$REPORT"
fi

log_message "Contr√¥le syst√®me effectu√© - Disque:$DISK_USAGE% RAM:$RAM_USAGE% CPU:$CPU_LOAD"
```

---

## üìö Ressources et Documentation

### üîó Liens Essentiels

| Cat√©gorie | Ressource | Description |
|-----------|-----------|-------------|
| **SSH** | [Guide OpenSSH](https://www.openssh.com/manual.html) | Documentation officielle SSH |
| **Bash** | [Guide Bash](https://notamax.be/bash-01-apprendre-a-scripter-sur-gnu-linux/) | Initiation au scripting Bash |
| **WP-CLI** | [Documentation Kinsta](https://kinsta.com/fr/blog/wp-cli/) | Guide complet WP-CLI |
| **AWS CLI** | [AWS S3 Backup](https://aws.amazon.com/fr/getting-started/hands-on/backup-to-s3-cli/) | Configuration AWS CLI |
| **Cron** | [Crontab Examples](https://geekflare.com/fr/crontab-linux-with-real-time-examples-and-tools/) | Exemples pratiques Cron |
| **Docker** | [Docker Documentation](https://docs.docker.com/) | Guide officiel Docker |

### ‚ö†Ô∏è Bonnes Pratiques de S√©curit√©

#### üîê Authentification
- **Cl√©s SSH** plut√¥t que mots de passe
- **Permissions restrictives** sur fichiers de cl√©s (400)
- **Authentification √† deux facteurs** quand possible
- **Rotation r√©guli√®re** des cl√©s et mots de passe

#### üõ°Ô∏è Surveillance
- **Monitoring automatis√©** des ressources critiques
- **Alertes email** configur√©es correctement  
- **Logs centralis√©s** et analys√©s r√©guli√®rement
- **Seuils d'alerte** adapt√©s √† l'environnement

#### üîÑ Maintenance
- **Sauvegardes automatis√©es** et test√©es
- **Mise √† jour syst√®me** planifi√©e
- **Nettoyage des logs** automatique
- **Documentation** des proc√©dures

---

## üö® Proc√©dures d'Urgence

### üîß Diagnostic Rapide

#### Serveur inaccessible
```bash
# V√©rifier les services essentiels
sudo systemctl status ssh nginx apache2 mysql

# V√©rifier l'espace disque
df -h

# V√©rifier la charge syst√®me
top -bn1 | head -20
```

#### Espace disque satur√©
```bash
# Nettoyage d'urgence
sudo apt autoremove && sudo apt autoclean
sudo find /var/log -name "*.log" -type f -mtime +7 -delete
sudo find /tmp -type f -mtime +7 -delete

# Identifier les gros fichiers
sudo du -ah --max-depth=2 / | sort -rh | head -20
```

#### M√©moire RAM satur√©e
```bash
# Identifier les processus gourmands
ps aux --sort=-%mem | head -10

# Red√©marrer les services si n√©cessaire
sudo systemctl restart apache2
sudo systemctl restart mysql
```

---

## üìû Support et Maintenance

### üìä Checklist de Surveillance Quotidienne

- [ ] **Espace disque** < 80%
- [ ] **Utilisation RAM** < 80%  
- [ ] **Charge CPU** acceptable
- [ ] **Services critiques** op√©rationnels
- [ ] **Logs d'erreur** v√©rifi√©s
- [ ] **Sauvegardes** effectu√©es

### üîÑ Maintenance Pr√©ventive

#### Hebdomadaire
- **Nettoyage des logs** anciens
- **V√©rification des certificats** SSL
- **Test des sauvegardes**
- **Mise √† jour des plugins** WordPress

#### Mensuelle  
- **Mise √† jour syst√®me** compl√®te
- **Audit des permissions** fichiers
- **Optimisation base de donn√©es**
- **Test des proc√©dures d'urgence**

---

*Document g√©n√©r√© le 2025-08-06 08:12:34 UTC par Gerardetienne - Version 5.0 - Guide Complet d'Administration Syst√®me*

# üóÑÔ∏è Guide Avanc√© - Base de Donn√©es et Administration Syst√®me

> **Auteur :** Gerardetienne  
> **Date de cr√©ation :** 2025-01-08  
> **Derni√®re mise √† jour :** 2025-01-08 08:15:36 UTC  
> **Version :** 6.0

---

## üìã Table des Mati√®res

1. [üíª Shells et Environnements](#-shells-et-environnements)
2. [üóÑÔ∏è Gestion Base de Donn√©es](#Ô∏è-gestion-base-de-donn√©es)
3. [üìÅ Transfert de Fichiers](#-transfert-de-fichiers)
4. [üêò PHP et Extensions](#-php-et-extensions)
5. [üîß WordPress Avanc√©](#-wordpress-avanc√©)
6. [üìä Moodle Administration](#-moodle-administration)
7. [üõ°Ô∏è S√©curit√© et Monitoring](#Ô∏è-s√©curit√©-et-monitoring)
8. [‚öôÔ∏è Configuration Serveur](#Ô∏è-configuration-serveur)
9. [üìù Scripts et Automatisation](#-scripts-et-automatisation)
10. [üîç Maintenance et Optimisation](#-maintenance-et-optimisation)

---

## üíª Shells et Environnements

### üêö Types de Shells disponibles

| Shell | Description | Usage |
|-------|-------------|--------|
| **bash** | **Bourne Again Shell** | 99% des distributions Linux |
| **sh** | **Bourne Shell** | Plus ancien, Unix/BSD |
| **zsh** | **Z Shell** | Compatible Bash avec fonctionnalit√©s avanc√©es |
| **csh** | **C Shell** | Syntaxe proche du langage C |

### üõ†Ô∏è Gestion des fichiers syst√®me

#### Vider un fichier sans le supprimer
```bash
echo /dev/null > fichier_a_vider
```

#### Modifier la date de derni√®re modification
> üìñ **R√©f√©rence :** [Script Bash pour supprimer des fichiers par p√©riode](https://webdevpro.net/script-de-bash-pour-supprimer-des-fichiers-et-dossiers-en-fonction-dune-periode/)

```bash
# Voir les informations d√©taill√©es d'un fichier
stat file_name.txt

# Afficher uniquement la date de cr√©ation
stat -c '%w' /home/user/file_name.txt
```

---

## üóÑÔ∏è Gestion Base de Donn√©es

> üìñ **Guide complet :** [MySQL Backup avec mysqldump](https://www.rosehosting.com/blog/how-to-create-a-backup-of-mysql-databases-using-mysqldump-on-ubuntu-20-04/)

### üíæ Sauvegarde MySQL (mysqldump)

#### Configuration de base locale
```bash
# Voir la configuration dans config.php
define( 'DB_NAME', 'maurice' );
define( 'DB_USER', 'maurice_user' );
define( 'DB_PASSWORD', 'Yh0R16OFEk14EEQJd4d' );
```

#### Dump basique
```bash
# Sauvegarde locale
mysqldump -u root -p moodle > backup.sql

# Exemple avec credentials
mysqldump -u root -p skiillz_30062022V1 > backup_$(date +%Y%m%d).sql
```

### ‚òÅÔ∏è Sauvegarde depuis AWS RDS

#### Export depuis RDS
```bash
# Commande compl√®te avec options RDS
mysqldump -u admin -p database_name \
          --host=your_db_host.region.rds.amazonaws.com \
          --set-gtid-purged=OFF \
          --column-statistics=0 > data_$(date +%Y%m%d).sql

# Avec mode verbose pour suivi
mysqldump --verbose -u admin -p database_name \
          --host=your_db_host.region.rds.amazonaws.com \
          --set-gtid-purged=OFF \
          --column-statistics=0 > data_verbose.sql
```

### üîÑ Restauration de base de donn√©es

#### Restauration locale
```bash
# Connexion √† MySQL
mysql -u root -p

# Restauration avec √©crasement
mysql --verbose -u root -p moodle < backup.sql
```

#### Restauration vers RDS
```bash
# Import vers AWS RDS
mysql --verbose -u admin -p database_name \
      --host=your_db_host.region.rds.amazonaws.com < data.sql
```

### üóÑÔ∏è Gestion des bases de donn√©es

> üìñ **R√©f√©rence :** [MySQL Database Management](https://gridscale.io/en/community/tutorials/mysql-datenbank-erstellen-loeschen/)

#### Commandes de base MySQL
```sql
-- Voir les bases de donn√©es
SHOW DATABASES;

-- Cr√©er une base
CREATE DATABASE nom_base CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- Supprimer une base
DROP DATABASE nom_base;

-- Utiliser une base
USE nom_base;

-- Voir les tables
SHOW TABLES;
```

### üîß Maintenance MySQL

#### Gestion des logs binaires
```sql
-- Voir les logs binaires
SHOW BINARY LOGS;

-- Purger les anciens logs (plus d'1 jour)
PURGE BINARY LOGS BEFORE DATE(NOW() - INTERVAL 1 DAY) + INTERVAL 0 SECOND;

-- Purger jusqu'√† un log sp√©cifique
PURGE BINARY LOGS TO 'mysql-bin.000123';
```

#### Nettoyage d'urgence (espace disque)
```bash
# Arr√™ter MySQL
sudo service mysql stop

# Aller dans le r√©pertoire MySQL
cd /var/lib/mysql

# Script de nettoyage (supprime la moiti√© des logs)
a=`ls | grep -v relay | grep bin.index`
b=`wc -l < $a`
c=`echo $(($b/2))`
head -n $c $a | cut -d "/" -f2 | xargs -I {} rm {}
sed "1,${c}d" $a -i

# Red√©marrer MySQL
sudo service mysql start
```

---

## üìÅ Transfert de Fichiers

### üîÑ SCP (Secure Copy Protocol)

#### Windows vers Ubuntu
```bash
# Transfert fichier local vers serveur
scp -i yourkey.pem C:\Users\username\Desktop\doc.zip ubuntu@13.59.88.232:/home/ubuntu/

# Exemple concret
scp -i yourkey.pem C:\Users\admin\Downloads\plugin.zip ubuntu@13.247.81.209:/home/ubuntu/
```

#### Entre serveurs Ubuntu
```bash
# Copie r√©cursive entre serveurs
scp -i /home/ubuntu/key.pem -r moodledata/ ubuntu@35.180.238.88:/home/ubuntu/

# Transfert de fichier unique
scp -i key.pem file.sql ubuntu@remote-server:/path/destination/
```

### üåê T√©l√©chargement direct

#### Avec curl
```bash
# T√©l√©charger un fichier
curl -O https://download.moodle.org/stable400/moodle-4.0.5.tgz

# Avec progression
curl -# -O https://wordpress.org/latest.zip
```

#### Avec wget
```bash
# T√©l√©chargement simple
wget https://download.moodle.org/stable400/moodle-4.0.5.tgz

# T√©l√©chargement en arri√®re-plan
wget -b https://example.com/large-file.zip
```

---

## üêò PHP et Extensions

### üîÑ Gestion des versions PHP

#### Mise √† jour PHP
```bash
# Ajouter le repository Ondrej
sudo apt-add-repository ppa:ondrej/php
sudo apt-get update

# R√©parer les d√©pendances cass√©es
sudo apt --fix-broken install

# Installer la nouvelle version
sudo apt-get install php7.4
```

#### Installation des extensions requises
```bash
# Extensions MySQL
sudo apt-get install php7.4-mysql

# Extensions compl√®tes pour Moodle/WordPress
sudo apt-get install php7.4-xml php7.4-xmlrpc php7.4-mbstring \
                     php7.4-curl php7.4-zip php7.4-gd php7.4-intl \
                     php7.4-soap php7.4-sodium
```

#### Changement de version Apache
```bash
# D√©sactiver l'ancienne version
sudo a2dismod php7.2

# Activer la nouvelle version
sudo a2enmod php7.4

# Red√©marrer Apache
sudo systemctl restart apache2
```

### üß™ Extensions sp√©ciales

#### SOAP pour Moodle
> üìñ **R√©f√©rence :** [Installation SOAP Extension](https://stackoverflow.com/questions/2509143/how-do-i-install-soap-extension)

```bash
# Installation selon version PHP
sudo apt install php7.4-soap
sudo service apache2 restart

# V√©rifier dans php.ini que l'extension est activ√©e
# extension=soap (d√©commenter si n√©cessaire)
```

#### Sodium pour cryptographie
```bash
# V√©rifier si install√©
php -i | grep sodium

# Installer si n√©cessaire
sudo apt install php-sodium

# Red√©marrer Apache
sudo /etc/init.d/apache2 restart
```

#### V√©rification des extensions
```bash
# Lister toutes les extensions install√©es
php -m | more

# Voir les informations PHP
php -i | less
```

### ‚öôÔ∏è Configuration PHP

#### Localisation fichiers de configuration

**Bitnami :**
```bash
# Fichier php.ini Bitnami
nano /opt/bitnami/php/etc/php.ini
```

**Ubuntu standard :**
```bash
# Configuration Apache
nano /etc/php/7.4/apache2/php.ini

# Configuration CLI
nano /etc/php/7.4/cli/php.ini
```

#### V√©rifications syst√®me
```bash
# Version PHP
php -v

# Version MySQL
mysql -V

# Configuration MySQL pour versions < 8.0
echo "default_storage_engine = innodb
innodb_file_per_table = 1
innodb_file_format = Barracuda" | sudo tee -a /etc/mysql/mysql.conf.d/mysqld.cnf
```

---

## üîß WordPress Avanc√©

### üéØ WP-CLI pour versions WordPress

> üìñ **Guide complet :** [WordPress Version Management](https://wpbeaches.com/upgrade-downgrade-website-versions-of-wordpress-with-wp-cli/)

#### Gestion des versions
```bash
# Voir la version actuelle
wp core version

# Mettre √† jour vers version sp√©cifique
wp core update --version=5.9.4 --force

# T√©l√©charger version sp√©cifique (sans contenu)
wp core download --skip-content --force --version=5.1.4

# Mise √† jour vers derni√®re version
wp core update
```

#### R√©solution des erreurs
```bash
# En cas d'erreur de mise √† jour bloqu√©e
wp option delete core_updater.lock
```

### üõ°Ô∏è Contr√¥le des mises √† jour automatiques

> üìñ **Guide :** [D√©sactiver mises √† jour WordPress](https://wpformation.com/desactiver-mises-a-jour-wordpress/)

#### Dans wp-config.php
```php
// D√©sactiver toutes les mises √† jour automatiques
define( 'AUTOMATIC_UPDATER_DISABLED', true );

// D√©sactiver uniquement les mises √† jour majeures
define( 'WP_AUTO_UPDATE_CORE', false );

// Activer uniquement les mises √† jour mineures
define( 'WP_AUTO_UPDATE_CORE', 'minor' );

// D√©sactiver le cron WordPress (pour gestion manuelle)
define('DISABLE_WP_CRON', true);
```

### üîß S√©curit√© WordPress apr√®s piratage

#### Nettoyage d'urgence
```bash
# Supprimer .htaccess corrompu
ls -la
rm .htaccess

# Voir les fichiers cach√©s malveillants
find . -name "*.php" -type f -exec grep -l "base64_decode\|eval(" {} \;
```

#### Blocage IP avec htaccess
> üìñ **Guide :** [Bloquer IP WordPress](https://wpcours.com/wp-tutoriels/bloquer-ip-acces-wordpress/)

```apache
order allow,deny
deny from 192.168.2.2
deny from 10.130.131.6
deny from 172.16.131.106
allow from all
```

#### Restauration propre
```bash
# 1. Sauvegarder wp-content et wp-config.php
cp -r wp-content wp-content-backup
cp wp-config.php wp-config-backup.php

# 2. Voir version WordPress actuelle
wp core version --allow-root

# 3. T√©l√©charger WordPress propre de m√™me version
# Vider le r√©pertoire et extraire WordPress neuf

# 4. Restaurer les fichiers sauvegard√©s
cp -r wp-content-backup/* wp-content/
cp wp-config-backup.php wp-config.php

# 5. Corriger les permissions
find . -type d -exec chmod 755 {} \;
find . -type f -exec chmod 664 {} \;
chown -R www-data:www-data .
```

---

## üìä Moodle Administration

### üìö Guides d'installation

> üìñ **R√©f√©rences officielles :**
> - [CloudCone Moodle Guide](https://cloudcone.com/docs/article/how-to-install-moodle-on-ubuntu-18-04/)
> - [Moodle Official Ubuntu Guide](https://docs.moodle.org/400/en/Step-by-step_Installation_Guide_for_Ubuntu)

### üîÑ Mise √† jour Moodle

> üìñ **Guide officiel :** [Moodle Upgrading](https://docs.moodle.org/400/en/Upgrading)

#### Dossiers √† sauvegarder (plugins ind√©pendants)
```bash
# Dossiers critiques √† pr√©server
cp -r filter filter-backup
cp -r blocks blocks-backup  
cp -r mod mod-backup
cp -r themes themes-backup
```

#### URLs d'administration
```bash
# Acc√®s upgrade Moodle
https://your-domain.com/admin/index.php?confirmupgrade=1&confirmrelease=1&showallplugins=1&cache=0

# Statistiques Moodle (apr√®s login admin)
https://cours.skiillz.com/my/
```

---

## üõ°Ô∏è S√©curit√© et Monitoring

### üîç Surveillance r√©seau et trafic

#### Installation ifstat
```bash
# Installer ifstat pour monitoring r√©seau
sudo apt-get install ifstat

# Surveiller le trafic r√©seau
ifstat -l
```

### üë• Gestion des processus

#### Surveillance des processus
```bash
# Vue interactive des processus
htop

# Vue arborescente
ps aux --forest

# Tuer un processus
kill PID_NUMBER
```

### ‚ö° Optimisation Apache MPM

#### Configuration Worker MPM
> üìñ **R√©f√©rence :** [Apache MaxRequestWorkers](https://stackoverflow.com/questions/36924952/ah00161-server-reached-maxrequestworkers-setting-consider-raising-the-maxreque)

```apache
# /etc/apache2/mods-available/mpm_worker.conf
<IfModule mpm_worker_module>
    StartServers             2
    MinSpareThreads          25
    MaxSpareThreads          75
    ThreadLimit              64
    ThreadsPerChild          25
    MaxRequestWorkers        150
    MaxConnectionsPerChild   0
    ServerLimit              256
</IfModule>
```

#### Configuration Prefork MPM
```apache
# /etc/apache2/mods-enabled/mpm_prefork.conf
<IfModule mpm_prefork_module>
    StartServers             5
    MinSpareServers          5
    MaxSpareServers          10
    MaxRequestWorkers        150
    MaxConnectionsPerChild   0
</IfModule>
```

### üìä Calcul des ressources

#### Formule MaxRequestWorkers
```bash
# Calcul recommand√©
# MaxRequestWorkers = RAM_disponible / RAM_par_processus

# Exemple avec 8GB RAM, 50MB par processus :
# 8000 MB / 50 MB = 160
# Donc MaxRequestWorkers = 160
```

#### Diagnostic Apache
```bash
# Voir le module MPM utilis√©
apache2ctl -V | grep MPM

# Voir tous les modules actifs
apache2ctl -M

# Compter les processus Apache
ps aux | grep apache | wc -l

# Voir configuration actuelle
egrep 'MaxRequestWorkers|ServerLimit' /etc/apache2/mods-enabled/mpm_prefork.conf
```

---

## ‚öôÔ∏è Configuration Serveur

### üíæ Extension d'espace disque (AWS)

> üìñ **Guide AWS :** [Recognize Expanded Volume Linux](https://docs.aws.amazon.com/fr_fr/AWSEC2/latest/UserGuide/recognize-expanded-volume-linux.html)

#### √âtapes d'extension
```bash
# 1. Voir la liste des espaces
lsblk

# 2. √âtendre la partition (selon lsblk)
sudo growpart /dev/nvme0n1 1

# 3a. Si syst√®me XFS
sudo xfs_growfs -d /

# 3b. Si syst√®me Ext4
sudo resize2fs /dev/nvme0n1p1

# Pour type xvda (EC2 plus anciens)
sudo growpart /dev/xvda 1
sudo xfs_growfs -d /
```

### üåê phpMyAdmin Bitnami

> üìñ **Guide officiel :** [Access phpMyAdmin Bitnami](https://docs.bitnami.com/aws/faq/get-started/access-phpmyadmin/)

#### Tunnel SSH pour acc√®s local
```bash
# Cr√©er tunnel SSH vers port 8888
ssh -N -L 8888:127.0.0.1:80 -i LightsailV2.pem bitnami@your-domain.com

# Exemple concret
ssh -N -L 8888:127.0.0.1:80 -i "LightsailDefaultKey-eu-west-3.pem" bitnami@15.237.52.208

# Acc√®s via navigateur local
# http://127.0.0.1:8888/phpmyadmin/
```

---

## üìù Scripts et Automatisation

### üîÅ Boucles Bash avanc√©es

> üìñ **R√©f√©rence :** [Loop Over Files in Bash](https://www.delftstack.com/fr/howto/linux/loop-over-files-in-bash/)

#### Parcours de fichiers
```bash
# Afficher tous les fichiers du r√©pertoire
for file in *; do echo $file; done

# √âcrire dans tous les fichiers
for file in *; do echo -e "$file\nHello World!" > $file; done

# Cr√©er des sauvegardes
for file in *; do cp $file "$file.bak"; done

# Copier vers un autre r√©pertoire
for filedir in *; do cp -r $filedir /mnt/efs/destination/ -v; done
```

### üîç Recherche et remplacement

#### Remplacement de texte avec sed
> üìñ **Guide :** [Find and Replace with sed](https://www.cyberciti.biz/faq/how-to-use-sed-to-find-and-replace-text-in-files-in-linux-unix-shell/)

```bash
# Remplacement simple
sudo sed -i 's/height: 60px/height: 80px/g' moderation/index.html

# Remplacement dans tous les fichiers du r√©pertoire
sed -i 's/ancienne_chaine/nouvelle_chaine/g' *

# Sauvegarde automatique avant modification
sed -i.bak 's/old/new/g' file.txt
```

#### Recherche de fichiers
```bash
# Chercher un nom de fichier sp√©cifique
find . -name 'subscribe.php' -print

# Chercher du contenu dans les fichiers
grep -r 'texte_recherche' ./

# Filtrer les logs WordPress
tail -f debug.log | grep error
```

### üßπ Scripts de nettoyage

#### Nettoyage des logs syst√®me
> üìñ **R√©f√©rence :** [Log File Management Ubuntu](https://unix.stackexchange.com/questions/130786/can-i-remove-files-in-var-log-journal-and-var-cache-abrt-di-usr)

```bash
# Voir l'espace occup√© par les journaux
journalctl --disk-usage

# Nettoyer jusqu'√† une taille limite
sudo journalctl --vacuum-size=500M

# Configuration permanente dans /etc/systemd/journald.conf
echo "SystemMaxUse=50M" | sudo tee -a /etc/systemd/journald.conf
sudo systemctl restart systemd-journald.service
```

#### Nettoyage syslog
```bash
# Vider le syslog
sudo > /var/log/syslog
sudo systemctl restart syslog
```

#### Configuration logrotate
```bash
# √âditer la configuration rsyslog
sudo nano /etc/logrotate.d/rsyslog

# Ajouter configuration avec limite de taille
/var/log/syslog
{
    rotate 7
    daily
    maxsize 1G
    missingok
    notifempty
    delaycompress
    compress
    postrotate
        /usr/lib/rsyslog/rsyslog-rotate
    endscript
}
```

---

## üîç Maintenance et Optimisation

### üìÇ Gestion avanc√©e des fichiers

#### Docker - R√©solution probl√®me base de donn√©es
```bash
# Voir les conteneurs actifs
docker ps

# Inspecter la configuration r√©seau
docker inspect nom_container_database
# R√©cup√©rer l'IPAddress

# Modifier wp-config.php avec la nouvelle IP
define( 'DB_HOST', '172.18.0.2' ); // IP du conteneur
```

### üîß Ex√©cution de fichiers PHP
```bash
# Ex√©cuter un script PHP en ligne de commande
php test.php

# Avec affichage des erreurs
php -d display_errors=1 test.php
```

### üåê Contr√¥le d'acc√®s et s√©curit√©

#### Blocage de sites (pare-feu applicatif)
> üìñ **R√©f√©rence :** [Bloquer acc√®s sites](https://sospc.name/bloquer-acces-sites/)

#### Gestion des logs journaux
```bash
# Contr√¥ler et supprimer fichiers journal Ubuntu
# R√©pertoire principal des journaux
ls -la /var/log/journal/

# Nettoyer selon la taille
sudo journalctl --vacuum-size=100M

# Nettoyer selon l'√¢ge
sudo journalctl --vacuum-time=7d
```

---

## üìö Ressources et Documentation

### üîó R√©f√©rences Essentielles

| Cat√©gorie | Ressource | Description |
|-----------|-----------|-------------|
| **MySQL** | [RoseHosting MySQL Backup](https://www.rosehosting.com/blog/how-to-create-a-backup-of-mysql-databases-using-mysqldump-on-ubuntu-20-04/) | Guide complet mysqldump |
| **Moodle** | [Official Installation Guide](https://docs.moodle.org/400/en/Step-by-step_Installation_Guide_for_Ubuntu) | Installation Ubuntu officielle |
| **WordPress** | [WP-CLI Version Management](https://wpbeaches.com/upgrade-downgrade-website-versions-of-wordpress-with-wp-cli/) | Gestion versions WordPress |
| **Apache** | [MaxRequestWorkers Tuning](https://bobcares.com/blog/server-reached-maxrequestworkers-setting/) | Optimisation Apache |
| **PHP** | [SOAP Extension Install](https://stackoverflow.com/questions/2509143/how-do-i-install-soap-extension) | Installation extensions PHP |
| **Bash** | [Loop Over Files](https://www.delftstack.com/fr/howto/linux/loop-over-files-in-bash/) | Scripts Bash avanc√©s |

### ‚ö†Ô∏è Bonnes Pratiques de Production

#### üîê S√©curit√© Base de Donn√©es
- **Sauvegardes automatis√©es** quotidiennes
- **Rotation des logs** binaires MySQL
- **Monitoring espace disque** en continu
- **Acc√®s restreint** aux utilisateurs privil√©gi√©s

#### üõ°Ô∏è S√©curit√© Web
- **Mise √† jour r√©guli√®re** des CMS (WordPress, Moodle)
- **Monitoring des plugins** et th√®mes
- **Scanning antivirus** p√©riodique
- **Blocage IP** automatis√© pour attaques

#### ‚ö° Performance
- **Optimisation Apache MPM** selon ressources
- **Cache appropri√©** pour applications
- **Compression gzip** activ√©e
- **Monitoring ressources** CPU/RAM/Disk

---

## üö® Proc√©dures d'Urgence

### üîß Base de Donn√©es Corrompue

#### MySQL ne d√©marre pas
```bash
# V√©rifier les logs MySQL
sudo tail -f /var/log/mysql/error.log

# R√©paration InnoDB
sudo mysqld --innodb-force-recovery=1

# Dump d'urgence si possible
mysqldump --single-transaction --all-databases > emergency_backup.sql
```

#### Espace disque satur√© par logs
```bash
# Nettoyage d'urgence logs MySQL
sudo service mysql stop
cd /var/lib/mysql
sudo rm mysql-bin.0*
sudo service mysql start

# Nettoyage logs syst√®me
sudo journalctl --vacuum-size=50M
sudo > /var/log/syslog
```

### üåê Site Web inaccessible

#### WordPress/Moodle compromis
```bash
# 1. Isoler le site
sudo a2dissite site-name

# 2. Scanner les fichiers malveillants
find /var/www/site/ -name "*.php" -exec grep -l "base64_decode\|eval(" {} \;

# 3. Restaurer depuis sauvegarde propre
# 4. Mettre √† jour tous les composants
# 5. Changer tous les mots de passe
```

#### Apache surcharg√©
```bash
# Red√©marrage d'urgence
sudo systemctl restart apache2

# V√©rifier les processus
ps aux | grep apache | wc -l

# Ajuster configuration MPM si n√©cessaire
sudo nano /etc/apache2/mods-enabled/mpm_prefork.conf
```

---

## üìû Support et Maintenance

### üìä Checklist Maintenance Hebdomadaire

- [ ] **Sauvegardes** base de donn√©es v√©rifi√©es
- [ ] **Espace disque** > 20% libre
- [ ] **Logs MySQL** purg√©s (> 7 jours)
- [ ] **Extensions PHP** √† jour
- [ ] **CMS et plugins** mis √† jour
- [ ] **Certificats SSL** valides
- [ ] **Monitoring** Apache MPM configur√©

### üîÑ Proc√©dures Mensuelles

#### Optimisation Base de Donn√©es
```bash
# Optimisation tables MySQL
mysqlcheck -u root -p --optimize --all-databases

# R√©paration si n√©cessaire  
mysqlcheck -u root -p --repair --all-databases

# Analyse des performances
mysql -u root -p -e "SHOW FULL PROCESSLIST;"
```

#### Audit S√©curit√©
```bash
# Recherche fichiers suspects
find /var/www/ -name "*.php" -mtime -7 -exec grep -l "eval\|base64_decode" {} \;

# V√©rification permissions
find /var/www/ -type f -perm 0777
find /var/www/ -type d -perm 0777

# Analyse logs acc√®s
awk '{print $1}' /var/log/apache2/access.log | sort | uniq -c | sort -nr | head -20
```

---

*Document g√©n√©r√© le 2025-01-08 08:15:36 UTC par Gerardetienne - Version 6.0 - Guide Avanc√© Base de Donn√©es et Administration Syst√®me*

</SimpleAuth>